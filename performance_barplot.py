import enum
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np


case_0_df = pd.DataFrame(data=[[0, 23.64, 1.888, 12.52, 2022, 'Megatron'],
                               [0, 23.64, 1.888, 12.55, 2023, 'Megatron'],
                               [0, 23.64, 1.888, 12.54, 2024, 'Megatron'],
                               [0, 47.28, 1.914, 24.70, 2022, 'Megatron'],
                               [0, 47.28, 1.914, 24.71, 2023, 'Megatron'],
                               [0, 47.28, 1.914, 24.66, 2024, 'Megatron'],
                               [0, 94.56, 1.933, 48.91, 2022, 'Megatron'],
                               [0, 94.56, 1.933, 48.76, 2023, 'Megatron'],
                               [0, 94.56, 1.933, 48.85, 2024, 'Megatron'],
                               [0, 31.52, 2.049, 15.38, 2022, 'Megatron'],
                               [0, 31.52, 2.049, 15.43, 2023, 'Megatron'],
                               [0, 31.52, 2.049, 15.30, 2024, 'Megatron'],
                               [0, 63.04, 2.066, 30.51, 2022, 'Megatron'],
                               [0, 63.04, 2.066, 30.31, 2023, 'Megatron'],
                               [0, 63.04, 2.066, 30.62, 2024, 'Megatron'],
                               [0, 126.08, 2.090, 60.32, 2022, 'Megatron'],
                               [0, 126.08, 2.090, 60.39, 2023, 'Megatron'],
                               [0, 126.08, 2.090, 60.31, 2024, 'Megatron'],
                               [0, 39.41, 2.087, 18.88, 2022, 'Megatron'],
                               [0, 39.41, 2.087, 18.77, 2023, 'Megatron'],
                               [0, 39.41, 2.087, 18.60, 2024, 'Megatron'],
                               [0, 78.82, 2.138, 36.87, 2022, 'Megatron'],
                               [0, 78.82, 2.138, 36.89, 2023, 'Megatron'],
                               [0, 78.82, 2.138, 36.86, 2024, 'Megatron'],
                               [0, 157.64, 2.161, 72.96, 2022, 'Megatron'],
                               [0, 157.64, 2.161, 72.93, 2023, 'Megatron'],
                               [0, 157.64, 2.161, 72.88, 2024, 'Megatron'],

                               [0, 23.64, 1.888, 14.69, 2022, 'DeepSpeed'],
                               [0, 23.64, 1.888, 14.8, 2023, 'DeepSpeed'],
                               [0, 23.64, 1.888, 14.72, 2024, 'DeepSpeed'],
                               [0, 47.28, 1.914, 28.83, 2022, 'DeepSpeed'],
                               [0, 47.28, 1.914, 28.87, 2023, 'DeepSpeed'],
                               [0, 47.28, 1.914, 28.34, 2024, 'DeepSpeed'],
                               [0, 94.56, 1.933, 59.58, 2022, 'DeepSpeed'],
                               [0, 94.56, 1.933, 57.91, 2023, 'DeepSpeed'],
                               [0, 94.56, 1.933, 58.34, 2024, 'DeepSpeed'],
                               [0, 31.52, 2.049, 25.43, 2022, 'DeepSpeed'],
                               [0, 31.52, 2.049, 25.94, 2023, 'DeepSpeed'],
                               [0, 31.52, 2.049, 24.56, 2024, 'DeepSpeed'],
                               [0, 63.04, 2.066, 46.29, 2022, 'DeepSpeed'],
                               [0, 63.04, 2.066, 46.67, 2023, 'DeepSpeed'],
                               [0, 63.04, 2.066, 46.1, 2024, 'DeepSpeed'],
                               [0, 126.08, 2.090, 89.57, 2022, 'DeepSpeed'],
                               [0, 126.08, 2.090, 90.83, 2023, 'DeepSpeed'],
                               [0, 126.08, 2.090, 91.45, 2024, 'DeepSpeed'],
                               [0, 39.41, 2.087, 38.55, 2022, 'DeepSpeed'],
                               [0, 39.41, 2.087, 38.08, 2023, 'DeepSpeed'],
                               [0, 39.41, 2.087, 38.52, 2024, 'DeepSpeed'],
                               [0, 78.82, 2.138, 73.95, 2022, 'DeepSpeed'],
                               [0, 78.82, 2.138, 73.43, 2023, 'DeepSpeed'],
                               [0, 78.82, 2.138, 74.57, 2024, 'DeepSpeed'],
                               [0, 157.64, 2.161, 149.62, 2022, 'DeepSpeed'],
                               [0, 157.64, 2.161, 149.62, 2023, 'DeepSpeed'],
                               [0, 157.64, 2.161, 149.64, 2024, 'DeepSpeed'],

                               [0, 23.64, 2.331, 10.14, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 23.64, 2.331, 10.21, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 23.64, 2.331, 10.08, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 47.28, 2.683, 17.62, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 47.28, 2.683, 17.63, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 47.28, 2.683, 17.81, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 94.56, 2.866, 32.99, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 94.56, 2.866, 32.98, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 94.56, 2.866, 33.19, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 31.52, 2.365, 13.33, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 31.52, 2.365, 13.24, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 31.52, 2.365, 13.13, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 63.04, 2.715, 23.22, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 63.04, 2.715, 23.21, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 63.04, 2.715, 23.12, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 126.08, 2.925, 43.10, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 126.08, 2.925, 43.34, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 126.08, 2.925, 43.18, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 39.41, 2.360, 16.70, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 39.41, 2.360, 16.68, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 39.41, 2.360, 16.65, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 78.82, 2.665, 29.58, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 78.82, 2.665, 29.51, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 78.82, 2.665, 29.42, 2024,
                                   'Ours (w/ Scheduler)'],
                               [0, 157.64, 2.930, 53.80, 2022,
                                   'Ours (w/ Scheduler)'],
                               [0, 157.64, 2.930, 53.76, 2023,
                                   'Ours (w/ Scheduler)'],
                               [0, 157.64, 2.930, 53.84, 2024,
                                   'Ours (w/ Scheduler)'],

                               [0, 23.64, 1.166, 20.27, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 23.64, 1.166, 19.46, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 23.64, 1.166, 20.19, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 47.28, 1.422, 33.25, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 47.28, 1.422, 32.32, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 47.28, 1.422, 33.10, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 94.56, 1.438, 65.78, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 94.56, 1.438, 67.13, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 94.56, 1.438, 66.43, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 31.52, 1.365, 23.09, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 31.52, 1.365, 24.72, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 31.52, 1.365, 22.12, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 63.04, 1.599, 39.43, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 63.04, 1.599, 40.25, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 63.04, 1.599, 39.29, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 126.08, 1.607, 78.47, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 126.08, 1.607, 79.06, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 126.08, 1.607, 79.59, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 39.41, 1.610, 24.48, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 39.41, 1.610, 24.48, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 39.41, 1.610, 24.48, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 78.82, 1.763, 44.71, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 78.82, 1.763, 44.71, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 78.82, 1.763, 44.71, 2024,
                                   'Ours (w/o Scheduler)'],
                               [0, 157.64, 1.776, 88.74, 2022,
                                   'Ours (w/o Scheduler)'],
                               [0, 157.64, 1.776, 88.71, 2023,
                                   'Ours (w/o Scheduler)'],
                               [0, 157.64, 1.776, 88.60, 2024,
                                   'Ours (w/o Scheduler)'],
                               ],
                         columns=['case', 'pflop', 'pflops', 'runtime', 'seed', 'system'])

case_1_df = pd.DataFrame(data=[[1, 23.64, 1.109, 21.31, 2022, 'Megatron'],
                               [1, 23.64, 1.109, 21.79, 2023, 'Megatron'],
                               [1, 23.64, 1.109, 20.79, 2024, 'Megatron'],
                               [1, 47.28, 1.116, 42.37, 2022, 'Megatron'],
                               [1, 47.28, 1.116, 42.04, 2023, 'Megatron'],
                               [1, 47.28, 1.116, 42.31, 2024, 'Megatron'],
                               [1, 94.56, 1.132, 83.57, 2022, 'Megatron'],
                               [1, 94.56, 1.132, 83.05, 2023, 'Megatron'],
                               [1, 94.56, 1.132, 83.93, 2024, 'Megatron'],
                               [1, 31.52, 1.360, 23.18, 2022, 'Megatron'],
                               [1, 31.52, 1.360, 22.94, 2023, 'Megatron'],
                               [1, 31.52, 1.360, 23.91, 2024, 'Megatron'],
                               [1, 63.04, 1.443, 43.68, 2022, 'Megatron'],
                               [1, 63.04, 1.443, 44.45, 2023, 'Megatron'],
                               [1, 63.04, 1.443, 43.57, 2024, 'Megatron'],
                               [1, 126.08, 1.474, 85.54, 2022, 'Megatron'],
                               [1, 126.08, 1.474, 85.34, 2023, 'Megatron'],
                               [1, 126.08, 1.474, 85.08, 2024, 'Megatron'],
                               [1, 39.41, 1.558, 25.29, 2022, 'Megatron'],
                               [1, 39.41, 1.558, 25.34, 2023, 'Megatron'],
                               [1, 39.41, 1.558, 25.39, 2024, 'Megatron'],
                               [1, 78.82, 1.595, 49.41, 2022, 'Megatron'],
                               [1, 78.82, 1.595, 49.53, 2023, 'Megatron'],
                               [1, 78.82, 1.595, 49.36, 2024, 'Megatron'],
                               [1, 157.64, 1.639, 96.16, 2022, 'Megatron'],
                               [1, 157.64, 1.639, 96.06, 2023, 'Megatron'],
                               [1, 157.64, 1.639, 95.68, 2024, 'Megatron'],

                               [1, 23.64, 1.888, 28.25, 2022, 'DeepSpeed'],
                               [1, 23.64, 1.888, 28.27, 2023, 'DeepSpeed'],
                               [1, 23.64, 1.888, 27.64, 2024, 'DeepSpeed'],
                               [1, 47.28, 1.914, 60.95, 2022, 'DeepSpeed'],
                               [1, 47.28, 1.914, 64.4, 2023, 'DeepSpeed'],
                               [1, 47.28, 1.914, 61.97, 2024, 'DeepSpeed'],
                               [1, 94.56, 1.933, 114.51, 2022, 'DeepSpeed'],
                               [1, 94.56, 1.933, 118.46, 2023, 'DeepSpeed'],
                               [1, 94.56, 1.933, 123.29, 2024, 'DeepSpeed'],
                               [1, 31.52, 2.049, 43.64, 2022, 'DeepSpeed'],
                               [1, 31.52, 2.049, 47.51, 2023, 'DeepSpeed'],
                               [1, 31.52, 2.049, 46.6, 2024, 'DeepSpeed'],
                               [1, 63.04, 2.066, 85.38, 2022, 'DeepSpeed'],
                               [1, 63.04, 2.066, 87.56, 2023, 'DeepSpeed'],
                               [1, 63.04, 2.066, 86.76, 2024, 'DeepSpeed'],
                               [1, 126.08, 2.090, 167.65, 2022, 'DeepSpeed'],
                               [1, 126.08, 2.090, 168.04, 2023, 'DeepSpeed'],
                               [1, 126.08, 2.090, 175.46, 2024, 'DeepSpeed'],
                               [1, 39.41, 2.087, 59.32, 2022, 'DeepSpeed'],
                               [1, 39.41, 2.087, 56.36, 2023, 'DeepSpeed'],
                               [1, 39.41, 2.087, 58.69, 2024, 'DeepSpeed'],
                               [1, 78.82, 2.138, 119.35, 2022, 'DeepSpeed'],
                               [1, 78.82, 2.138, 119.73, 2023, 'DeepSpeed'],
                               [1, 78.82, 2.138, 121.56, 2024, 'DeepSpeed'],
                               [1, 157.64, 2.161, 240.13, 2022, 'DeepSpeed'],
                               [1, 157.64, 2.161, 241.07, 2023, 'DeepSpeed'],
                               [1, 157.64, 2.161, 247.69, 2024, 'DeepSpeed'],

                               [1, 23.64, 1.917, 12.33, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 23.64, 1.917, 12.35, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 23.64, 1.917, 12.38, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 47.28, 2.063, 22.92, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 47.28, 2.063, 23.07, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 47.28, 2.063, 23.01, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 94.56, 2.090, 45.24, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 94.56, 2.090, 45.17, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 94.56, 2.090, 45.59, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 31.52, 2.004, 15.73, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 31.52, 2.004, 15.27, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 31.52, 2.004, 15.83, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 63.04, 2.176, 28.97, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 63.04, 2.176, 28.98, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 63.04, 2.176, 28.70, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 126.08, 2.252, 55.99, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 126.08, 2.252, 55.64, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 126.08, 2.252, 55.88, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 39.41, 2.138, 18.43, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 39.41, 2.138, 18.60, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 39.41, 2.138, 18.44, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 78.82, 2.292, 34.39, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 78.82, 2.292, 34.91, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 78.82, 2.292, 33.42, 2024,
                                   'Ours (w/ Scheduler)'],
                               [1, 157.64, 2.345, 67.23, 2022,
                                   'Ours (w/ Scheduler)'],
                               [1, 157.64, 2.345, 66.90, 2023,
                                   'Ours (w/ Scheduler)'],
                               [1, 157.64, 2.345, 68.23, 2024,
                                   'Ours (w/ Scheduler)'],

                               [1, 23.64, 1.545, 15.30, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 23.64, 1.545, 14.99, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 23.64, 1.545, 14.96, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 47.28, 1.681, 28.12, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 47.28, 1.681, 27.83, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 47.28, 1.681, 27.99, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 94.56, 1.760, 53.72, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 94.56, 1.760, 53.56, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 94.56, 1.760, 52.47, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 31.52, 1.683, 18.73, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 31.52, 1.683, 18.89, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 31.52, 1.683, 18.99, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 63.04, 1.883, 33.48, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 63.04, 1.883, 32.23, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 63.04, 1.883, 34.20, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 126.08, 1.957, 64.44, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 126.08, 1.957, 66.42, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 126.08, 1.957, 63.78, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 39.41, 1.819, 21.67, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 39.41, 1.819, 22.61, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 39.41, 1.819, 20.74, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 78.82, 1.969, 40.03, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 78.82, 1.969, 41.67, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 78.82, 1.969, 40.30, 2024,
                                   'Ours (w/o Scheduler)'],
                               [1, 157.64, 2.042, 77.20, 2022,
                                   'Ours (w/o Scheduler)'],
                               [1, 157.64, 2.042, 79.32, 2023,
                                   'Ours (w/o Scheduler)'],
                               [1, 157.64, 2.042, 77.23, 2024,
                                   'Ours (w/o Scheduler)'],
                               ],
                         columns=['case', 'pflop', 'pflops', 'runtime', 'seed', 'system'])

case_2_df = pd.DataFrame(data=[[2, 23.64, 0.701, 33.72, 2022, 'Megatron'],
                               [2, 23.64, 0.701, 32.59, 2023, 'Megatron'],
                               [2, 23.64, 0.701, 32.77, 2024, 'Megatron'],
                               [2, 47.28, 0.792, 59.69, 2022, 'Megatron'],
                               [2, 47.28, 0.792, 58.43, 2023, 'Megatron'],
                               [2, 47.28, 0.792, 59.01, 2024, 'Megatron'],
                               [2, 94.56, 0.850, 111.31, 2022, 'Megatron'],
                               [2, 94.56, 0.850, 110.31, 2023, 'Megatron'],
                               [2, 94.56, 0.850, 110.49, 2024, 'Megatron'],
                               [2, 31.52, 0.928, 33.98, 2022, 'Megatron'],
                               [2, 31.52, 0.928, 33.02, 2023, 'Megatron'],
                               [2, 31.52, 0.928, 33.17, 2024, 'Megatron'],
                               [2, 63.04, 1.048, 60.17, 2022, 'Megatron'],
                               [2, 63.04, 1.048, 59.21, 2023, 'Megatron'],
                               [2, 63.04, 1.048, 59.48, 2024, 'Megatron'],
                               [2, 126.08, 1.122, 112.40, 2022, 'Megatron'],
                               [2, 126.08, 1.122, 111.39, 2023, 'Megatron'],
                               [2, 126.08, 1.122, 111.66, 2024, 'Megatron'],
                               [2, 39.41, 1.065, 37.01, 2022, 'Megatron'],
                               [2, 39.41, 1.065, 35.97, 2023, 'Megatron'],
                               [2, 39.41, 1.065, 36.01, 2024, 'Megatron'],
                               [2, 78.82, 1.211, 65.06, 2022, 'Megatron'],
                               [2, 78.82, 1.211, 64.05, 2023, 'Megatron'],
                               [2, 78.82, 1.211, 64.12, 2024, 'Megatron'],
                               [2, 157.64, 1.292, 121.98, 2022, 'Megatron'],
                               [2, 157.64, 1.292, 121.10, 2023, 'Megatron'],
                               [2, 157.64, 1.292, 121.02, 2024, 'Megatron'],

                               [2, 23.64, 1.888, 163.86, 2022, 'DeepSpeed'],
                               [2, 23.64, 1.888, 163.54, 2023, 'DeepSpeed'],
                               [2, 23.64, 1.888, 162.89, 2024, 'DeepSpeed'],
                               [2, 47.28, 1.914, 329.29, 2022, 'DeepSpeed'],
                               [2, 47.28, 1.914, 324.15, 2023, 'DeepSpeed'],
                               [2, 47.28, 1.914, 325.35, 2024, 'DeepSpeed'],
                               [2, 94.56, 1.933, 659.72, 2022, 'DeepSpeed'],
                               [2, 94.56, 1.933, 658.1, 2023, 'DeepSpeed'],
                               [2, 94.56, 1.933, 659.25, 2024, 'DeepSpeed'],
                               [2, 31.52, 2.049, 245.18, 2022, 'DeepSpeed'],
                               [2, 31.52, 2.049, 244.53, 2023, 'DeepSpeed'],
                               [2, 31.52, 2.049, 243.99, 2024, 'DeepSpeed'],
                               [2, 63.04, 2.066, 486.18, 2022, 'DeepSpeed'],
                               [2, 63.04, 2.066, 486.77, 2023, 'DeepSpeed'],
                               [2, 63.04, 2.066, 488, 2024, 'DeepSpeed'],
                               [2, 126.08, 2.090, 975.36, 2022, 'DeepSpeed'],
                               [2, 126.08, 2.090, 972.51, 2023, 'DeepSpeed'],
                               [2, 126.08, 2.090, 972.29, 2024, 'DeepSpeed'],
                               [2, 39.41, 2.087, 330.99, 2022, 'DeepSpeed'],
                               [2, 39.41, 2.087, 333.27, 2023, 'DeepSpeed'],
                               [2, 39.41, 2.087, 332.11, 2024, 'DeepSpeed'],
                               [2, 78.82, 2.138, 660.97, 2022, 'DeepSpeed'],
                               [2, 78.82, 2.138, 661.79, 2023, 'DeepSpeed'],
                               [2, 78.82, 2.138, 659.85, 2024, 'DeepSpeed'],
                               [2, 157.64, 2.161, 1325.62, 2022, 'DeepSpeed'],
                               [2, 157.64, 2.161, 1322.99, 2023, 'DeepSpeed'],
                               [2, 157.64, 2.161, 1327.24, 2024, 'DeepSpeed'],

                               [2, 23.64, 1.240, 19.06, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 23.64, 1.240, 18.92, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 23.64, 1.240, 18.63, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 47.28, 1.447, 32.67, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 47.28, 1.447, 32.47, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 47.28, 1.447, 32.20, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 94.56, 1.735, 54.50, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 94.56, 1.735, 54.38, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 94.56, 1.735, 53.86, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 31.52, 1.410, 22.35, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 31.52, 1.410, 22.03, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 31.52, 1.410, 21.95, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 63.04, 1.686, 37.39, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 63.04, 1.686, 36.92, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 63.04, 1.686, 37.24, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 126.08, 1.956, 64.45, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 126.08, 1.956, 64.29, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 126.08, 1.956, 63.92, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 39.41, 1.459, 27.02, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 39.41, 1.459, 26.94, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 39.41, 1.459, 26.38, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 78.82, 1.755, 44.91, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 78.82, 1.755, 44.81, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 78.82, 1.755, 44.38, 2024,
                                   'Ours (w/ Scheduler)'],
                               [2, 157.64, 2.015, 78.23, 2022,
                                   'Ours (w/ Scheduler)'],
                               [2, 157.64, 2.015, 78.87, 2023,
                                   'Ours (w/ Scheduler)'],
                               [2, 157.64, 2.015, 78.79, 2024,
                                   'Ours (w/ Scheduler)'],

                               [2, 23.64, 0.850, 27.80, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 23.64, 0.850, 27.70, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 23.64, 0.850, 27.96, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 47.28, 0.945, 50.01, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 47.28, 0.945, 49.82, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 47.28, 0.945, 50.19, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 94.56, 1.013, 93.35, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 94.56, 1.013, 92.33, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 94.56, 1.013, 92.91, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 31.52, 1.064, 29.62, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 31.52, 1.064, 29.01, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 31.52, 1.064, 29.57, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 63.04, 1.231, 51.22, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 63.04, 1.231, 50.93, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 63.04, 1.231, 50.86, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 126.08, 1.328, 94.91, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 126.08, 1.328, 94.07, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 126.08, 1.328, 94.32, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 39.41, 1.208, 32.62, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 39.41, 1.208, 31.05, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 39.41, 1.208, 31.76, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 78.82, 1.409, 55.95, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 78.82, 1.409, 55.21, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 78.82, 1.409, 55.61, 2024,
                                   'Ours (w/o Scheduler)'],
                               [2, 157.64, 1.540, 102.34, 2022,
                                   'Ours (w/o Scheduler)'],
                               [2, 157.64, 1.540, 98.83, 2023,
                                   'Ours (w/o Scheduler)'],
                               [2, 157.64, 1.540, 99.29, 2024,
                                   'Ours (w/o Scheduler)'],
                               ],
                         columns=['case', 'pflop', 'pflops', 'runtime', 'seed', 'system'])

case_3_df = pd.DataFrame(data=[[3, 23.64, 0.421, 56.20, 2022, 'Megatron'],
                               [3, 23.64, 0.421, 62.36, 2023, 'Megatron'],
                               [3, 23.64, 0.421, 59.76, 2024, 'Megatron'],
                               [3, 47.28, 0.463, 102.08, 2022, 'Megatron'],
                               [3, 47.28, 0.463, 106.41, 2023, 'Megatron'],
                               [3, 47.28, 0.463, 104.93, 2024, 'Megatron'],
                               [3, 94.56, 0.488, 193.72, 2022, 'Megatron'],
                               [3, 94.56, 0.488, 197.92, 2023, 'Megatron'],
                               [3, 94.56, 0.488, 195.62, 2024, 'Megatron'],
                               [3, 31.52, 0.523, 60.31, 2022, 'Megatron'],
                               [3, 31.52, 0.523, 64.82, 2023, 'Megatron'],
                               [3, 31.52, 0.523, 63.51, 2024, 'Megatron'],
                               [3, 63.04, 0.580, 108.64, 2022, 'Megatron'],
                               [3, 63.04, 0.580, 112.52, 2023, 'Megatron'],
                               [3, 63.04, 0.580, 111.90, 2024, 'Megatron'],
                               [3, 126.08, 0.612, 206.11, 2022, 'Megatron'],
                               [3, 126.08, 0.612, 211.91, 2023, 'Megatron'],
                               [3, 126.08, 0.612, 209.05, 2024, 'Megatron'],
                               [3, 39.41, 0.617, 63.86, 2022, 'Megatron'],
                               [3, 39.41, 0.617, 69.48, 2023, 'Megatron'],
                               [3, 39.41, 0.617, 66.63, 2024, 'Megatron'],
                               [3, 78.82, 0.689, 114.33, 2022, 'Megatron'],
                               [3, 78.82, 0.689, 120.37, 2023, 'Megatron'],
                               [3, 78.82, 0.689, 117.03, 2024, 'Megatron'],
                               [3, 157.64, 0.729, 216.38, 2022, 'Megatron'],
                               [3, 157.64, 0.729, 221.44, 2023, 'Megatron'],
                               [3, 157.64, 0.729, 218.43, 2024, 'Megatron'],

                               [3, 23.64, 1.888, 240.39, 2022, 'DeepSpeed'],
                               [3, 23.64, 1.888, 240.01, 2023, 'DeepSpeed'],
                               [3, 23.64, 1.888, 240.44, 2024, 'DeepSpeed'],
                               [3, 47.28, 1.914, 475.8, 2022, 'DeepSpeed'],
                               [3, 47.28, 1.914, 481.59, 2023, 'DeepSpeed'],
                               [3, 47.28, 1.914, 480.94, 2024, 'DeepSpeed'],
                               [3, 94.56, 1.933, 956.61, 2022, 'DeepSpeed'],
                               [3, 94.56, 1.933, 957.95, 2023, 'DeepSpeed'],
                               [3, 94.56, 1.933, 959.64, 2024, 'DeepSpeed'],
                               [3, 31.52, 2.049, 551.35, 2022, 'DeepSpeed'],
                               [3, 31.52, 2.049, 551.96, 2023, 'DeepSpeed'],
                               [3, 31.52, 2.049, 555.67, 2024, 'DeepSpeed'],
                               [3, 63.04, 2.066, 1110.51, 2022, 'DeepSpeed'],
                               [3, 63.04, 2.066, 1096.01, 2023, 'DeepSpeed'],
                               [3, 63.04, 2.066, 1102.59, 2024, 'DeepSpeed'],
                               [3, 126.08, 2.090, 2198.83, 2022, 'DeepSpeed'],
                               [3, 126.08, 2.090, 2212.89, 2023, 'DeepSpeed'],
                               [3, 126.08, 2.090, 2195.66, 2024, 'DeepSpeed'],
                               [3, 39.41, 2.087, 841.98, 2022, 'DeepSpeed'],
                               [3, 39.41, 2.087, 847.14, 2023, 'DeepSpeed'],
                               [3, 39.41, 2.087, 846.81, 2024, 'DeepSpeed'],
                               [3, 78.82, 2.138, 1676.73, 2022, 'DeepSpeed'],
                               [3, 78.82, 2.138, 1676.73, 2023, 'DeepSpeed'],
                               [3, 78.82, 2.138, 1669.82, 2024, 'DeepSpeed'],
                               [3, 157.64, 2.161, 3377.49, 2022, 'DeepSpeed'],
                               [3, 157.64, 2.161, 3367.26, 2023, 'DeepSpeed'],
                               [3, 157.64, 2.161, 3348.84, 2024, 'DeepSpeed'],

                               [3, 23.64, 1.063, 22.24, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 23.64, 1.063, 21.85, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 23.64, 1.063, 21.81, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 47.28, 1.222, 38.68, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 47.28, 1.222, 38.36, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 47.28, 1.222, 38.42, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 94.56, 1.313, 72.02, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 94.56, 1.313, 71.76, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 94.56, 1.313, 71.76, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 31.52, 1.201, 26.24, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 31.52, 1.201, 26.01, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 31.52, 1.201, 25.97, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 63.04, 1.381, 45.66, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 63.04, 1.381, 45.76, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 63.04, 1.381, 45.38, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 126.08, 1.465, 86.07, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 126.08, 1.465, 85.73, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 126.08, 1.465, 85.79, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 39.41, 1.244, 31.69, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 39.41, 1.244, 31.69, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 39.41, 1.244, 31.38, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 78.82, 1.523, 51.75, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 78.82, 1.523, 51.55, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 78.82, 1.523, 51.45, 2024,
                                   'Ours (w/ Scheduler)'],
                               [3, 157.64, 1.651, 95.46, 2022,
                                   'Ours (w/ Scheduler)'],
                               [3, 157.64, 1.651, 95.15, 2023,
                                   'Ours (w/ Scheduler)'],
                               [3, 157.64, 1.651, 95.11, 2024,
                                   'Ours (w/ Scheduler)'],

                               [3, 23.64, 0.739, 31.99, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 23.64, 0.739, 31.77, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 23.64, 0.739, 31.96, 2024,
                                   'Ours (w/o Scheduler)'],

                               [3, 47.28, 0.828, 57.07, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 47.28, 0.828, 56.98, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 47.28, 0.828, 57.01, 2024,
                                   'Ours (w/o Scheduler)'],
                               [3, 94.56, 0.891, 106.12, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 94.56, 0.891, 105.76, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 94.56, 0.891, 106.02, 2024,
                                   'Ours (w/o Scheduler)'],
                               [3, 31.52, 0.933, 33.78, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 31.52, 0.933, 33.62, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 31.52, 0.933, 33.59, 2024,
                                   'Ours (w/o Scheduler)'],

                               [3, 63.04, 1.079, 58.42, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 63.04, 1.079, 58.54, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 63.04, 1.079, 58.60, 2024,
                                   'Ours (w/o Scheduler)'],
                               [3, 126.08, 1.158, 108.91, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 126.08, 1.158, 107.81, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 126.08, 1.158, 108.21, 2024,
                                   'Ours (w/o Scheduler)'],
                               [3, 39.41, 1.048, 37.62, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 39.41, 1.048, 37.43, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 39.41, 1.048, 37.39, 2024,
                                   'Ours (w/o Scheduler)'],
                               [3, 78.82, 1.240, 63.58, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 78.82, 1.240, 62.12, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 78.82, 1.240, 62.48, 2024,
                                   'Ours (w/o Scheduler)'],
                               [3, 157.64, 1.360, 115.90, 2022,
                                   'Ours (w/o Scheduler)'],
                               [3, 157.64, 1.360, 112.34, 2023,
                                   'Ours (w/o Scheduler)'],
                               [3, 157.64, 1.360, 113.74, 2024,
                                   'Ours (w/o Scheduler)'],
                               ],
                         columns=['case', 'pflop', 'pflops', 'runtime', 'seed', 'system'])

case_4_df = pd.DataFrame(data=[[4, 23.64, 0.141, 167.74, 2022, 'Megatron'],
                               [4, 23.64, 0.141, 164.38, 2023, 'Megatron'],
                               [4, 23.64, 0.141, 164.63, 2024, 'Megatron'],
                               [4, 47.28, 0.157, 301.30, 2022, 'Megatron'],
                               [4, 47.28, 0.157, 297.88, 2023, 'Megatron'],
                               [4, 47.28, 0.157, 298.45, 2024, 'Megatron'],
                               [4, 94.56, 0.165, 572.48, 2022, 'Megatron'],
                               [4, 94.56, 0.165, 569.22, 2023, 'Megatron'],
                               [4, 94.56, 0.165, 569.25, 2024, 'Megatron'],
                               [4, 31.52, 0.175, 180.11, 2022, 'Megatron'],
                               [4, 31.52, 0.175, 176.51, 2023, 'Megatron'],
                               [4, 31.52, 0.175, 176.91, 2024, 'Megatron'],
                               [4, 63.04, 0.201, 313.90, 2022, 'Megatron'],
                               [4, 63.04, 0.201, 310.85, 2023, 'Megatron'],
                               [4, 63.04, 0.201, 311.32, 2024, 'Megatron'],
                               [4, 126.08, 0.216, 584.52, 2022, 'Megatron'],
                               [4, 126.08, 0.216, 580.88, 2023, 'Megatron'],
                               [4, 126.08, 0.216, 581.78, 2024, 'Megatron'],
                               [4, 39.41, 0.209, 188.17, 2022, 'Megatron'],
                               [4, 39.41, 0.209, 184.87, 2023, 'Megatron'],
                               [4, 39.41, 0.209, 185.69, 2024, 'Megatron'],
                               [4, 78.82, 0.242, 326.02, 2022, 'Megatron'],
                               [4, 78.82, 0.242, 322.29, 2023, 'Megatron'],
                               [4, 78.82, 0.242, 322.66, 2024, 'Megatron'],
                               [4, 157.64, 0.265, 595.64, 2022, 'Megatron'],
                               [4, 157.64, 0.265, 591.08, 2023, 'Megatron'],
                               [4, 157.64, 0.265, 592.07, 2024, 'Megatron'],

                               [4, 23.64, 1.888, 589.43, 2022, 'DeepSpeed'],
                               [4, 23.64, 1.888, 584.14, 2023, 'DeepSpeed'],
                               [4, 23.64, 1.888, 577.56, 2024, 'DeepSpeed'],
                               [4, 47.28, 1.914, 1158.05, 2022, 'DeepSpeed'],
                               [4, 47.28, 1.914, 1143.81, 2023, 'DeepSpeed'],
                               [4, 47.28, 1.914, 1209.49, 2024, 'DeepSpeed'],
                               [4, 94.56, 1.933, 2375.95, 2022, 'DeepSpeed'],
                               [4, 94.56, 1.933, 2383.01, 2023, 'DeepSpeed'],
                               [4, 94.56, 1.933, 2377.42, 2024, 'DeepSpeed'],
                               [4, 31.52, 2.049, 1106.35, 2022, 'DeepSpeed'],
                               [4, 31.52, 2.049, 1105.22, 2023, 'DeepSpeed'],
                               [4, 31.52, 2.049, 1100.08, 2024, 'DeepSpeed'],
                               [4, 63.04, 2.066, 2251.42, 2022, 'DeepSpeed'],
                               [4, 63.04, 2.066, 2203.13, 2023, 'DeepSpeed'],
                               [4, 63.04, 2.066, 2138.95, 2024, 'DeepSpeed'],
                               [4, 126.08, 2.090, 4360.72, 2022, 'DeepSpeed'],
                               [4, 126.08, 2.090, 4430.44, 2023, 'DeepSpeed'],
                               [4, 126.08, 2.090, 4393.58, 2024, 'DeepSpeed'],
                               [4, 39.41, 2.087, 1666.32, 2022, 'DeepSpeed'],
                               [4, 39.41, 2.087, 1647.07, 2023, 'DeepSpeed'],
                               [4, 39.41, 2.087, 1657.18, 2024, 'DeepSpeed'],
                               [4, 78.82, 2.138, 3223.25, 2022, 'DeepSpeed'],
                               [4, 78.82, 2.138, 3202.5, 2023, 'DeepSpeed'],
                               [4, 78.82, 2.138, 3241.68, 2024, 'DeepSpeed'],
                               [4, 157.64, 2.161, 6799.17, 2022, 'DeepSpeed'],
                               [4, 157.64, 2.161, 6727.32, 2023, 'DeepSpeed'],
                               [4, 157.64, 2.161, 6510.85, 2024, 'DeepSpeed'],

                               [4, 23.64, 0.540, 43.78, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 23.64, 0.540, 44.39, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 23.64, 0.540, 43.87, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 47.28, 0.759, 62.27, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 47.28, 0.759, 62.90, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 47.28, 0.759, 62.59, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 94.56, 0.909, 104.06, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 94.56, 0.909, 104.53, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 94.56, 0.909, 104.08, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 31.52, 0.617, 51.06, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 31.52, 0.617, 51.63, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 31.52, 0.617, 51.13, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 63.04, 0.876, 71.96, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 63.04, 0.876, 72.46, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 63.04, 0.876, 72.02, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 126.08, 1.106, 114.01, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 126.08, 1.106, 114.57, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 126.08, 1.106, 113.91, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 39.41, 0.677, 58.24, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 39.41, 0.677, 58.92, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 39.41, 0.677, 58.55, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 78.82, 0.977, 80.68, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 78.82, 0.977, 81.34, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 78.82, 0.977, 80.92, 2024,
                                   'Ours (w/ Scheduler)'],
                               [4, 157.64, 1.271, 124.07, 2022,
                                   'Ours (w/ Scheduler)'],
                               [4, 157.64, 1.271, 124.56, 2023,
                                   'Ours (w/ Scheduler)'],
                               [4, 157.64, 1.271, 124.23, 2024,
                                   'Ours (w/ Scheduler)'],

                               [4, 23.64, 0.256, 92.29, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 23.64, 0.256, 89.64, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 23.64, 0.256, 93.46, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 47.28, 0.285, 165.89, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 47.28, 0.285, 162.10, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 47.28, 0.285, 163.80, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 94.56, 0.302, 313.63, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 94.56, 0.302, 308.01, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 94.56, 0.302, 315.88, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 31.52, 0.318, 99.10, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 31.52, 0.318, 97.21, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 31.52, 0.318, 99.50, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 63.04, 0.365, 172.54, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 63.04, 0.365, 165.46, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 63.04, 0.365, 168.49, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 126.08, 0.393, 320.63, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 126.08, 0.393, 311.32, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 126.08, 0.393, 324.41, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 39.41, 0.369, 106.71, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 39.41, 0.369, 100.61, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 39.41, 0.369, 108.18, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 78.82, 0.435, 181.16, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 78.82, 0.435, 171.87, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 78.82, 0.435, 181.80, 2024,
                                   'Ours (w/o Scheduler)'],
                               [4, 157.64, 0.476, 331.25, 2022,
                                   'Ours (w/o Scheduler)'],
                               [4, 157.64, 0.476, 313.98, 2023,
                                   'Ours (w/o Scheduler)'],
                               [4, 157.64, 0.476, 335.31, 2024,
                                   'Ours (w/o Scheduler)'],
                               ],
                         columns=['case', 'pflop', 'pflops', 'runtime', 'seed', 'system'])

cases_df = [case_0_df, case_1_df, case_2_df, case_3_df, case_4_df]


def plot_performance(subfig=None):
    axes = subfig.subplots(nrows=5, ncols=1, sharex=True)
    for i, df in enumerate(cases_df):
        ax = sns.barplot(ax=axes[i], data=df, x='pflop', y='runtime',
                         hue="system", hue_order=["Ours (w/ Scheduler)", "Ours (w/o Scheduler)", "Megatron", "DeepSpeed"],
                         palette=["C2", "C1", "C0", "C3"],
                         alpha=0.8, ci="sd", errwidth=0.6, capsize=0.2)
        ax.set_ylabel('Runtime per iteration (s)')
        ax.set_xlabel(None)
        if i == 0:
            ax.set(ylim=(0, 200))
        if i == 1:
            ax.set(ylim=(0, 300))
        if i == 2:
            ax.set(ylim=(0, 1500))
        elif i == 3:
            ax.set(ylim=(0, 4000))
        elif i == 4:
            ax.set(ylim=(0, 7000))

        if i == 4:
            axes[i].set_xlabel('Model Architectures')
            ax.set(xticklabels=['L24\nB1k', 'L24\nB2k', 'L24\nB4k',
                                'L32\nB1k', 'L32\nB2k', 'L32\nB4k',
                                'L40\nB1k', 'L40\nB2k', 'L40\nB4k', ])
            ax.get_legend().set_title(None)
            handles, labels = ax.get_legend_handles_labels()
            ax.legend(handles=[handles[0], handles[2], handles[1], handles[3]], labels=[labels[0], labels[2], labels[1], labels[3]],
                      loc='lower center', handletextpad=0.1, columnspacing=0.1, bbox_to_anchor=(
                0.48, -0.5), ncol=2, prop={'size': 9}, facecolor='white')
        else:
            ax.get_legend().remove()
